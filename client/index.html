{% extends "layout.html" %}


{% macro introPanel(text) %}
<p>{{text}}</p>
<p><button class="game__ready-button">I'm ready</button></p>
{% endmacro %}

{% macro resultPanel(text, slug) %}
<h4>TIME</h4>`,
<p><button class="retry-button">Retry</button></p>,
<p><i>pretty results table TKTK</i></p>,
<p><a href="#{{slug}}">Next</a></p>`,
{% endmacro %}

{% macro comparison() %}
<div class="level__comparison">
THIS SHOWS THE COMPASION DATA
</div>
{% endmacro %}

{% macro replayButton(slug, label) %}
<button name="replay-level" value="{{ slug }}">{{ label }}</button>
{% endmacro %}

{% macro nextButton(name, num, src) %}
<button class="next-level-button" name="next-level">
  <img src="{{ src }}" alt="">
  <p>Next up, level {{ num }}: {{ name }}</p>
  <span class="next-level-button__target">I'm ready</span>
</button>
{% endmacro%}

{% macro statePanel(slug, state) %}
<div class="level__state level__state--{{slug}}" data-state="{{ state }}">
{{ caller() }}
</div>
{% endmacro %}

{% macro countdown(slug, intro) %}
  {% call statePanel(slug, "countdown") %}
  <button class="countdown-status game__race-button" name="stopwatch-stop">WAIT</button>
  {% endcall %}
{% endmacro %}

{% macro falseStart(slug) %}
  {% call statePanel(slug, "false-start") %}
  <p>False start</p>
  {{ replayButton(slug, "Try again") }}
  {% endcall %}
{% endmacro %}

{% macro normalStart(slug) %}
  {% call statePanel(slug, "normal-start") %}
  <p class="result-summary"></p>
  {% endcall %}
{% endmacro %}

{% macro noStart(slug) %}
  {% call statePanel(slug, "no-start") %}
  <p>What happened, you didn't leave blocks?</p>
  {{ replayButton(slug, "Restart") }}
  {% endcall %}
{% endmacro %}

{% macro clock(slug, d) %}
<div class="clock">{{ d }}</div>
<div class="clock clock--{{ slug }}" data-clock="{{ slug }}">0.00</div>
{% endmacro %}

{% block article_body %}


<ul class="level-icons">
{% for level in levels %}
  <li><i class="{{ level.slug }}"></i></li>
{% endfor %}
</ul>

<b>Use headphones or turn up your sound!</b>

<div class="play-button-wrapper">
  <button name="first-level">Play as a man</button>
  <button name="first-level">Play as a woman</button>
  <span class="loading-indicator">Loading...</span>
  <button class="play-game-button">Play game</button>
</div>


{% for level in levels %}
  <div class="level" data-level="{{ level.slug }}">
    {{ clock(level.slug, level.clockname) }}
    <div class="level__states">
      {{ countdown(level.slug, level.intro) }}
      <div class="level__complete">
        {{ normalStart(level.slug) }}
        {{ falseStart(level.slug) }}
        {{ noStart(level.slug) }}
        {{ comparison(level.slug) }}
        {{ nextButton(level.sportname, loop.index + 1, level.nextimage, level.slug) }}
      </div>
    </div>
  </div>
{% endfor %}
{% endblock %}
